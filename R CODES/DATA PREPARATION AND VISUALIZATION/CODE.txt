#LOADING THE REQUIRED PACKAGES

library(ggplot2)
library(tidyverse)

#IMPORTING THE DATA
df <- read.csv("train.csv")
df1 <- df

#DISPLAYING THE NUMBER OF ROWS AND COLUMNS OF DATA
dim(df1)

#DISPLAYING THE FIRST 6 ROWS OF THE DATA
head(df1)

#DISPLAYING THE COLUMN NAMES IN THE DATA
names(df1)

#DISPLAYING THE STRUCTURE AND SUMMARY OF DATA
str(df1)
summary(df1)

#CHECKING THE DATA FOR ANY MISSING VALUES. IF FOUND CLEANING THE DATA IS REQUIRED
sum(is.na(df))

#REMOVING THE COLUMN NAMED ID
df1$ID <- NULL

#OUR TARGET VARIABLE IS REACHED ON TIME
#DISPLAYING THE PROPORTION OF TARGET VARIABLE
table <- table(df1$Reached.on.Time_Y.N)
table
#WE CAN ANALYZE THAT 4436 ORDERS DELIVERED ON TIME AND 6563 ORDERS WERE NOT DELIVERED ON TIME

#DISPLAYING THE DELIVERY RATE
prop.table(table)
#WE CAN ANALYZE THAT THE ON TIME DELIVERY RATE IS 0.4033094 I.E.. 40.33% AND NOT ON TIME DELIVERY RATE IS 0.5966906 I.E.. 59.66%


#CONVERTING THE TARGET VARIABLES AND PREDICTORS TO FACTOR CLASS
df1$Reached.on.Time_Y.N <- as.factor(df1$Reached.on.Time_Y.N)
df1$Customer_care_calls <- as.factor(df1$Customer_care_calls)
df1$Customer_rating <- as.factor(df1$Customer_rating)
df1$Prior_purchases <- as.factor(df1$Prior_purchases)

#FINDING THE AVERAGE ORDER VALUE
total_revenue <- sum(df1$Cost_of_the_Product)
total_orders <- nrow(df1)
avg_order_value <- total_revenue/total_orders
avg_order_value
#WE CAN ANALYZE THAT THE AVERAGE AMOUNT OF MONEY EACH CUSTOMER IS SPENDING PER ORDER IS 210.1968 USD
#FROM THIS VALUE WE CAN PRESCRIPT THAT THE COMPANY SHOULD RECOMMEND RELEVANT PRODUCTS AND PROVIDE MINIMUM ORDER FOR DISCOUNT SHIPPING

#DISPLAYING PRIOR PURCHASES TABLE
table(df1$Prior_purchases)
#FROM THIS TABLE WE CAN ANALYZE THAT PRIOR PURCHASE OF 3 ORDERS ARE HAVING MAXIMUM CUSTOMERS AND PRIOR PURCHASE OF 8 ORDERS ARE HAVING MINIMUM CUSTOMERS

#DISPLAYING THE REVENUE GENERATED BY CUSTOMERS WHO HAVE MADE 3 PRIOR PURCHASES AND 8 PRIOR PURCHASES
revenue <- df1 %>%
  filter(Prior_purchases=="3") %>%
  summarize(revenue=sum(Cost_of_the_Product))
revenue

revenue1 <- df1 %>%
  filter(Prior_purchases=="8") %>%
  summarize(revenue1=sum(Cost_of_the_Product))
revenue1

#DISPLAYING THE TABLES FOR PREDICTORS AND TARGET VARIABLE
xtabs(~Warehouse_block+Reached.on.Time_Y.N,data=df1)

xtabs(~Mode_of_Shipment+Reached.on.Time_Y.N,data=df1)

xtabs(~Customer_care_calls+Reached.on.Time_Y.N,data=df1)

xtabs(~ Customer_rating+Reached.on.Time_Y.N,data=df1)

xtabs(~ Prior_purchases+Reached.on.Time_Y.N,data=df1)

xtabs(~Product_importance+Reached.on.Time_Y.N,data=df1)

xtabs(~Discount_offered+Reached.on.Time_Y.N,data=df1)

xtabs(~Weight_in_gms+Reached.on.Time_Y.N,data=df1)


#DATA VISUALIZATION
#WAREHOUSE BLOCK VS REACHED ON TIME
ggplot(df1,aes(Warehouse_block))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Warehouse Block vs Reached On Time",x="Warehouse Blocks")

#MODE OF SHIPMENT VS REACHED ON TIME
ggplot(df1,aes(Mode_of_Shipment))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Mode of shipment vs Reached On Time",x="Mode of shipment")

#CUSTOMER CARE CALLS VS REACHED ON TIME
ggplot(df1,aes(Customer_care_calls))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Customer Care Calls vs Reached On Time",x="No:of Customer care calls")

#CUSTOMER RATING VS REACHED ON TIME
ggplot(df1,aes(Customer_rating))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Customer Rating vs Reached On Time",x="Customer Rating")

#PRIOR PURCHASE VS REACHED ON TIME
ggplot(df1,aes(Prior_purchases))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Prior Purchases vs Reached On Time",x="No:of prior purchases")

#PRODUCT IMPORTANCE VS REACHED ON TIME
ggplot(df1,aes(Product_importance))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Product Importance vs Reached On Time",x="Product Importance")

#GENDER VS REACHED ON TIME
ggplot(df1,aes(Gender))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Gender vs Reached On Time",x="Gender")

#COST OF THE PRODUCT VS REACHED ON TIME
ggplot(df1,aes(Cost_of_the_Product))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Cost of the product vs Reached On Time",x="Cost of the product")

#WEIGHT VS REACHED ON TIME
ggplot(df1,aes(Weight_in_gms))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Weight vs Reached On Time",x="Weight")

#DISCOUNT OFFERED VS REACHED ON TIME
ggplot(df1,aes(Discount_offered))+geom_bar(aes(fill=Reached.on.Time_Y.N))+labs(title="Discount Offered vs Reached On Time",x="Discount Offered")

#FROM THE BAR PLOT WE CAN SEE THAT WE CAN'T INFER MUCH FROM IT. SO WE USE HISTOGRAM PLOT

#HISTOGRAM PLOT FOR COST OF THE PRODUCT VS REACHED ON TIME
ggplot(df1,aes(Cost_of_the_Product))+geom_histogram(bin=30,binwidth = 39,col="red",fill="white")+labs(title="Cost Of The Product (USD)",x="Cost Of The Product ($)")

#HISTOGRAM PLOT FOR WEIGHT VS REACHED ON TIME
ggplot(df1,aes(Weight_in_gms))+geom_histogram(bin=30,binwidth = 39,col="red",fill="white")+labs(title="Weight (grams)",x="Weight(g)")

#HISTOGRAM PLOT FOR DISCOUNT OFFERED VS REACHED ON TIME
ggplot(df1,aes(Discount_offered))+geom_histogram(bin=30,binwidth = 39,col="red",fill="white")+labs(title="Discount Offered",x="Discount offered percentage")